<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Wetter">
    <meta name="theme-color" content="#0ea5e9">
    <link rel="apple-touch-icon" href="AppleIcon.png">
    <link rel="stylesheet" href="Style.css">
    <title>Better</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="theme-light min-h-screen text-white font-sans">

    <!-- iOS Overscroll-Fix: Fester Hintergrund-Layer, verhindert weißen Rand beim Rubber-Banding -->
    <div id="background-layer" class="background-layer">
        <div id="sky-bg" class="sky-bg"></div>
        <div class="sky-layer sky-atmosphere"></div>
        <div class="sky-layer sky-haze"></div>
        <div class="sky-layer sky-clouds-far"></div>
        <div class="sky-layer sky-clouds-mid"></div>
        <div class="sky-layer sky-clouds-near"></div>
        <div class="sky-layer sky-stars"></div>
        <div class="sky-layer sky-precip"></div>
    </div>

    <!-- ========================================
         HAUPTBEREICH
         Komplettes Layout statisch im HTML.
         Keine Layout-Erzeugung im Script.
         Alle dynamischen Bereiche mit eindeutigen IDs.
         ======================================== -->
    <main id="app" class="h-full p-5 pt-14 pb-10 max-w-md mx-auto select-none">

        <!-- Header: Stadtname + Steuerung -->
        <header id="header" class="text-center mb-8 relative">
            <button id="refresh-btn"
                    class="absolute top-0 left-0 text-white/70 text-2xl w-10 h-10 flex items-center justify-center rounded-full active:bg-white/10"
                    aria-label="Aktualisieren">
                ↻
            </button>
            <button id="city-toggle-btn"
                    class="inline-flex items-center gap-1"
                    aria-label="Stadt wechseln">
                <span id="city-name" class="text-lg font-medium tracking-wide">—</span>
                <svg class="w-4 h-4 opacity-60" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/>
                </svg>
            </button>
        </header>

        <!-- Aktuelles Wetter -->
        <section id="current-weather" class="text-center mb-10">
            <div id="weather-icon" class="text-8xl mb-2 leading-none">—</div>
            <div id="current-temp" class="text-8xl font-extralight tracking-tighter mb-1">—</div>
            <div id="weather-desc" class="text-lg opacity-80 mb-1">—</div>
            <div id="apparent-temp" class="text-sm opacity-60">—</div>
        </section>

        <!-- Detail-Karten: Wind, Feuchtigkeit, Regen -->
        <section id="details" class="grid grid-cols-3 gap-3 mb-5">
            <div class="glass rounded-2xl p-3 text-center">
                <div class="text-xs opacity-60 uppercase tracking-wider mb-1">Wind</div>
                <div id="wind-speed" class="text-xl font-semibold">—</div>
            </div>
            <div class="glass rounded-2xl p-3 text-center">
                <div class="text-xs opacity-60 uppercase tracking-wider mb-1">Feuchte</div>
                <div id="humidity" class="text-xl font-semibold">—</div>
            </div>
            <div class="glass rounded-2xl p-3 text-center">
                <div class="text-xs opacity-60 uppercase tracking-wider mb-1">Regen</div>
                <div id="rain-probability" class="text-xl font-semibold">—</div>
            </div>
        </section>

        <section id="hourly-section" class="mb-6 glass rounded-2xl p-4 text-center">
            <div id="hourly-scroll" class="flex overflow-x-auto no-scrollbar"></div>
        </section>

        <!-- 10-Tage-Vorhersage -->
        <section id="forecast" class="glass rounded-2xl p-4">
            <h2 class="text-xs opacity-60 uppercase tracking-wider mb-3">10-Tage-Vorhersage</h2>
            <div id="forecast-list" class="divide-y divide-white/10"></div>
        </section>

        <!-- Sonnenzeiten -->
        <section id="sun-times" class="glass rounded-2xl p-4 mb-5 mt-5 flex justify-around">
            <div class="text-center">
                <div class="text-xs opacity-60 uppercase tracking-wider mb-1">☀ Aufgang</div>
                <div id="sunrise" class="text-xl font-semibold">—</div>
            </div>
            <div class="w-px bg-white/20"></div>
            <div class="text-center">
                <div class="text-xs opacity-60 uppercase tracking-wider mb-1">☽ Untergang</div>
                <div id="sunset" class="text-xl font-semibold">—</div>
            </div>
        </section>

        <!-- Temperatur-Graph -->
        <section id="temp-graph-section" class="glass rounded-2xl p-4 mt-5 relative">
            <h2 class="text-xs opacity-60 uppercase tracking-wider mb-3">Temperaturverlauf</h2>
            <svg id="temp-graph" viewBox="0 0 320 160" class="w-full" preserveAspectRatio="xMidYMid meet"></svg>
            <div id="graph-tooltip" class="graph-tooltip absolute hidden bg-slate-900/90 backdrop-blur text-white text-xs rounded-lg px-3 py-2 shadow-lg z-10"></div>
        </section>

    </main>

    <!-- Stadteingabe-Overlay -->
    <div id="city-overlay" class="hidden fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-start justify-center pt-28 px-5">
        <div class="bg-slate-800/95 backdrop-blur-lg rounded-2xl p-5 w-full max-w-sm shadow-2xl">
            <h3 class="text-white text-lg font-semibold mb-4">Stadt suchen</h3>
            <input id="city-input"
                   type="text"
                   class="w-full bg-slate-700/80 text-white rounded-xl px-4 py-3 mb-4 outline-none focus:ring-2 focus:ring-blue-400 placeholder-white/40"
                   placeholder="Stadtname eingeben…"
                   autocomplete="off" />
            <div class="flex gap-3">
                <button id="city-cancel-btn"
                        class="flex-1 bg-slate-700 text-white/80 rounded-xl py-3 font-medium active:bg-slate-600">
                    Abbrechen
                </button>
                <button id="city-submit-btn"
                        class="flex-1 bg-blue-500 text-white rounded-xl py-3 font-medium active:bg-blue-600">
                    Suchen
                </button>
            </div>
        </div>
    </div>

    <!-- Lade-Overlay -->
    <div id="loading-overlay" class="hidden fixed inset-0 bg-black/20 backdrop-blur-sm z-40 flex items-center justify-center">
        <div class="flex flex-col items-center gap-3">
            <div class="w-10 h-10 border-white/30 border-t-white rounded-full spinner" style="border-width: 3px; border-style: solid"></div>
            <span class="text-white/80 text-sm">Wetterdaten laden…</span>
        </div>
    </div>

    <!-- Fehlermeldung -->
    <div id="error-display" class="hidden fixed bottom-6 left-4 right-4 bg-red-500/90 backdrop-blur text-white rounded-2xl p-4 text-center text-sm z-50 shadow-lg max-w-md mx-auto"></div>

    <!-- Tages-Detail Bottom Sheet -->
    <div id="day-sheet-overlay" class="fixed inset-0 bg-black/40 backdrop-blur-sm z-50">
        <div id="day-sheet" class="absolute bottom-0 left-0 right-0 bg-slate-800/95 backdrop-blur-lg rounded-t-3xl p-5 pt-3 max-w-md mx-auto shadow-2xl text-white" style="max-height:85vh;overflow-y:hidden">
            <!-- Drag-Handle -->
            <div id="day-sheet-handle" class="flex justify-center mb-3 pt-1 cursor-grab active:cursor-grabbing" style="touch-action:none">
                <div class="w-10 h-1 rounded-full bg-white/30"></div>
            </div>
            <!-- Titel -->
            <h3 id="day-sheet-title" class="text-lg font-semibold text-center mb-4"></h3>
            <!-- Temperatur-Graph -->
            <div class="mb-2 relative">
                <h4 class="text-xs opacity-60 uppercase tracking-wider mb-2">Temperatur</h4>
                <svg id="day-temp-graph" viewBox="0 0 320 160" class="w-full" preserveAspectRatio="xMidYMid meet" style="touch-action:none"></svg>
            </div>
            <!-- Regen-Graph -->
            <div class="relative">
                <h4 class="text-xs opacity-60 uppercase tracking-wider mb-2">Niederschlag</h4>
                <svg id="day-rain-graph" viewBox="0 0 320 160" class="w-full" preserveAspectRatio="xMidYMid meet" style="touch-action:none"></svg>
            </div>
        </div>
    </div>
    <!-- Graph-Interaktions-Tooltip (fixed, schwebt über Sheet) -->
    <div id="day-graph-tooltip" class="day-graph-tooltip fixed hidden bg-black/80 text-white text-xs rounded-xl px-3 py-2 shadow-lg"></div>


<script type="text/javascript" src="index.js"></script>
</body>
</html>

